---
title: "Developmental Changes in the Relationship Between Grammar and the Lexicon"
author: "Mika Braginsky, Daniel Yurovsky, Virginia Marchman, and Michael Frank"
date: "February 4, 2015"
output:
  html_document:
    highlight: tango
    theme: spacelab
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(cache=TRUE, message=FALSE, warning=FALSE)
```

```{r fonts, include=FALSE}
library(extrafont)
font_import()
font = "Tahoma"
```

***

## Data Loading

Load required libraries.
```{r libraries, cache=FALSE}
library(arm)
library(ggplot2)
library(dplyr)
library(tidyr)
library(RMySQL)
library(stringr)
```

Load in Wordbank data.
```{r database, cache=FALSE}
# open database connection
wordbank <- src_mysql(dbname="wordbank", host="54.149.39.46",
                      user="wordbank", password="wordbank")

# load tables
source.table <- tbl(wordbank, "common_source")
admin.table <- tbl(wordbank, "common_administration")
child.table <- tbl(wordbank, "common_child")
wordmapping.table <- tbl(wordbank, "common_wordmapping")
instruments.table <- tbl(wordbank, "common_instrumentsmap")
norwegian.ws.table <- tbl(wordbank, "instruments_norwegian_ws")
english.ws.table <- tbl(wordbank, "instruments_english_ws")
danish.ws.table <- tbl(wordbank, "instruments_danish_ws")
spanish.ws.table <- tbl(wordbank, "instruments_spanish_ws")
```

Get child and administration data. 
```{r child_data}
# get administration info
admins <- admin.table %>%
  select(data_id,child_id,age,source_id) %>%
  rename(id = data_id, child.id = child_id, source.id = source_id) 
admins <- as.data.frame(admins)

# get demographic variables for each child
demos <- select(child.table,id,sex,mom_ed,birth_order) %>%
  rename(child.id = id) # Rename id fields
demos <- as.data.frame(demos)

# join administrations and demographics together
child.data <- as.tbl(left_join(admins,demos))
```

Get item data.
```{r item_data}
# get item info
mapping <- as.data.frame(wordmapping.table)

# get instrument info
instruments <- as.data.frame(instruments.table) %>%
  rename(instrument_id = id)

# join items and instruments together
items <- left_join(mapping, instruments) %>%
  mutate(language = factor(language, levels = c("Norwegian", "English", "Danish", "Spanish")))
```

Show number of items in each relevant section.
```{r}
sections <- items %>%
  filter(form == "WS") %>%
  group_by(language, type) %>%
  summarise(n = n()) %>%
  spread(type, n) %>%
  select(language, word, word_form, complexity)
kable(sections)
```

Function for getting all of the data points for a given language (kid x item).
```{r fun_data}
get.language.data <- function(lang.table, lang.items, lang, child.data) {
  
  instrument.items <- lang.items %>% 
    filter(language == lang, form == 'WS') %>%
    select(item, type, category, lexical_category, definition, complexity_category) %>%
    mutate(item = str_replace(item, "\\.", "_")) # fix _/. inconsistencies
  
  instrument.data <- as.data.frame(lang.table) %>%
    rename(id = basetable_ptr_id) %>% # Rename the id
    gather(item, value, -id) %>% # Arrange in longform
    mutate(item = str_replace(item, "item_", "")) # Strip off item_ 
  
  d <- left_join(instrument.data, instrument.items)
  d <- left_join(d, child.data)
  }
```

Get (kid x item) data for all languages.
```{r data}
d.norwegian <- get.language.data(lang.table=norwegian.ws.table, 
                                 lang.items=items, 
                                 lang="Norwegian",
                                 child.data)
d.norwegian[d.norwegian$type %in% c("word_form","word")
            & is.na(d.norwegian$value),]$value = ""

d.english <- get.language.data(lang.table=english.ws.table, 
                               lang.items=items, 
                               lang="English",
                               child.data)

d.danish <- get.language.data(lang.table=danish.ws.table, 
                              lang.items=items, 
                              lang="Danish",
                              child.data)
d.danish[d.danish$type %in% c("word_form","word")
         & is.na(d.danish$value),]$value = ""

d.spanish <- get.language.data(lang.table=spanish.ws.table, 
                               lang.items=items, 
                               lang="Spanish",
                               child.data)
```

Function for getting vocabulary size data.
```{r fun_vocab_size}
language.vocab.sizes <- function(lang.data) {
  d.vocab <- lang.data %>%
    filter(type == "word") %>%
    group_by(age,id) %>%
    summarise(vocab.sum = sum(value == "produces", na.rm=TRUE),
              vocab.mean = vocab.sum / length(value))
  
  return(d.vocab)
  }
```

Function for getting (kid x {vocab size, syntax score, morphology score}) data.
```{r fun_summarise}
summarise.language.data <- function(lang.data,lang) {
  
  d.vocab <- language.vocab.sizes(lang.data)
  
  d.complexity <- lang.data %>%
    filter(type == "complexity") %>%
    group_by(id) %>%
    summarise(all.na = all(is.na(value)),
              complexity.sum = sum(value == "complex", 
                                   na.rm=TRUE),
              complexity.diff = length(value) - complexity.sum,
              complexity.mean = complexity.sum / length(value)) %>%
    mutate(complexity.sum = ifelse(all.na, NA, complexity.sum),
           complexity.diff = ifelse(all.na, NA, complexity.diff),
           complexity.mean = ifelse(all.na, NA, complexity.mean)) %>%
    select(-all.na)
  
  d.wordform <- lang.data %>%
    filter(type == "word_form") %>%
    group_by(id) %>%
    summarise(all.na = all(is.na(value)),
              wordform.sum = sum(value == "produces", 
                                 na.rm=TRUE),
              wordform.diff = length(value) - wordform.sum,
              wordform.mean = wordform.sum / length(value)) %>%
    mutate(wordform.sum = ifelse(all.na, NA, wordform.sum),
           wordform.diff = ifelse(all.na, NA, wordform.diff),
           wordform.mean = ifelse(all.na, NA, wordform.mean)) %>%
    select(-all.na)
  
  d.composite <- left_join(d.complexity, d.vocab)
  d.composite <- left_join(d.wordform, d.composite) %>%
    ungroup() %>%
    filter(age > 15 & age < 32) %>%
    mutate(age.group = cut(age, breaks = c(15, 19, 23, 27, 31)))
  
  d.composite$language <- lang
  
  return(d.composite)
  }
```

Get (kid x {vocab size, syntax score, morphology score}) data for all languages and aggregate them.
```{r summarise}
summary.norwegian <- summarise.language.data(d.norwegian,"Norwegian")
summary.english <- summarise.language.data(d.english,"English")
summary.danish <- summarise.language.data(d.danish,"Danish")
summary.spanish <- summarise.language.data(d.spanish,"Spanish")

summary.data <- rbind_list(summary.norwegian, summary.english,
                           summary.danish, summary.spanish) %>%
  mutate(language = factor(language, levels=c("Norwegian", "English", "Danish", "Spanish")))

ms <- summary.data %>% 
  gather(measure.value, score, wordform.mean, wordform.sum, wordform.diff,
         complexity.mean, complexity.sum, complexity.diff) %>%
  extract(measure.value, c("measure","value"), "([[:alnum:]]+)\\.([[:alnum:]]+)") %>%
  spread(value,score) %>%
  mutate(measure = factor(measure, levels = c("wordform","complexity"),
                          labels = c("Word Form", "Complexity")))
```

Show total number of administrations in each language and number of administrations with grammar data in each langauge.
```{r n}
n.total <- ms %>%
  group_by(language, measure) %>%
  summarise(total = n()) %>%
  filter(measure=="Complexity") %>%
  select(-measure)

n.grammar <- ms %>%
  filter(!is.na(sum)) %>%
  group_by(language, measure) %>%
  summarise(with.grammar = n()) %>%
  filter(measure=="Complexity") %>%
  select(-measure)

ns <- inner_join(n.total, n.grammar)
kable(ns)
```

Show number of administrations in each language by age group.
```{r n_age}
n.age <- ms %>% 
  group_by(language, age.group) %>% 
  summarise(n = n()) %>%
  spread(age.group, n)
kable(n.age)
```

***

## Analysis 1: Syntax and Morphology

Fit grammar models and use them to predict data.
```{r grammar_predict}
glm.predicted.data <- filter(ms, !is.na(sum))
glm.predicted.data$predicted <- NA

for (lang in c("Norwegian", "English", "Danish", "Spanish")) {
  for (meas in c("Word Form", "Complexity")) {
    model <- glm(cbind(sum,diff) ~ vocab.mean + age.group,
                 data = filter(glm.predicted.data,
                               language==lang, measure==meas),
                 family="binomial")
    predict <- invlogit(predict.lm(model,
                                   glm.predicted.data[glm.predicted.data$language==lang & glm.predicted.data$measure==meas,]))
    glm.predicted.data[glm.predicted.data$language==lang & glm.predicted.data$measure==meas,]$predicted <- predict
    }
  }
```

Plot score as a function of vocabulary size for each language and measure with model prediction curves.
```{r grammar_data_plot, fig.width=6, fig.height=6}
ggplot(glm.predicted.data, aes(x = vocab.mean, y = mean, 
                               colour = age.group, fill = age.group,
                               label = age.group)) + 
  geom_jitter(alpha=.3, size=.75) +
  geom_line(aes(y=predicted),size=0.65) + 
  facet_grid(language~measure) + 
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,.2),
                     name = "Vocabulary Size") + 
  scale_y_continuous(limits = c(0,1), breaks = seq(0,1,.25),
                     "Score (Mean Items)") + 
  theme_bw(base_size = 11) +
  theme(legend.position = c(0.06,0.92),
        legend.text = element_text(size=7),
        legend.title = element_text(size=7),
        legend.key.height = unit(0.7, "char"),
        legend.key.width = unit(0.4, "cm"),
        legend.key = element_blank(),
        legend.background = element_rect(fill="transparent"),
        text=element_text(family=font)) +
  scale_color_brewer(type="div", palette=9,
                     name="Age Group\n (months)") +
  scale_fill_brewer(palette = "Spectral",
                    guide=FALSE)
```

```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/grammar.png"), width=6, height=6, dpi=300)
```

Fit grammar models and get their AICs and age coefficients.
```{r grammar_models}
grammar.models <- ms %>%
  filter(!is.na(sum)) %>%
  group_by(language, measure) %>%
  do(model.vocab = glm(cbind(sum,diff) ~ vocab.mean, data = .,
                       family="binomial"),
     model.vocab.age = glm(cbind(sum,diff) ~ vocab.mean + age, data = .,
                           family="binomial"),
     model.vocab.age = glm(cbind(sum,diff) ~ vocab.mean * age, data = .,
                           family="binomial")) %>%
  mutate(AIC.vocab = AIC(model.vocab),
         AIC.vocab.age = AIC(model.vocab.age),
         deltaAIC = AIC.vocab - AIC.vocab.age,
         age.coef = coef(model.vocab.age)["age"],
         age.se = se.coef(model.vocab.age)["age"])
```

Show AICs of grammar models.
```{r grammar_aic}
display.grammar.models <- grammar.models %>%
  select(language, measure, AIC.vocab, AIC.vocab.age, deltaAIC)
kable(display.grammar.models)
```

Plot age effect coefficients for each language and measure.
```{r grammar_coef_plot, fig.width=6, fig.height=4}
ggplot(grammar.models, 
       aes(x=language, y=age.coef, fill=measure)) + 
  geom_bar(position="dodge", stat="identity") + 
  geom_linerange(aes(ymin=age.coef-1.96*age.se, ymax=age.coef+1.96*age.se), 
                 position = position_dodge(width=.9)) +
  ylab("Age effect coefficient") + 
  xlab("Language") +
  theme_bw(base_size = 14) +
  scale_fill_brewer(palette="Set2",
                    name="Measure") +
  theme(legend.position = c(0.15,0.86),
        legend.text = element_text(size=14),
        legend.title = element_text(size=15),
        legend.key.height = unit(1.5, "char"),
        legend.key = element_blank(),
        legend.background = element_rect(fill="transparent"),
        text=element_text(family=font))
```

```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/coefs_wordform_complexity.png"), width=6, height=4, dpi=300)
```

Get (kid x item x {vocab size, value}) data for wordform and complexity items.
```{r grammar_by_item}
get.item.type <- function(type, complexity_category) {
  if(type == "complexity") {
    return(complexity_category)
    } else {
      return(type)
      }
  }

grammar.by.item <- function(lang.data) {
  
  d.vocab <- language.vocab.sizes(lang.data)
  
  d.complexity <- lang.data %>%
    filter(type == "complexity") %>%
    mutate(value = value == "complex") %>%
    select(-lexical_category, -category)
  
  d.wordform <- lang.data %>%
    filter(type == "word_form") %>%
    mutate(value = value == "produces") %>%
    select(-lexical_category, -category)
  
  d.data <- rbind(d.complexity, d.wordform) %>%
    rowwise() %>%
    mutate(coded.type = get.item.type(type, complexity_category)) %>%
    select(-complexity_category)
  
  d.data <- left_join(d.vocab, d.data) %>%
    filter(age > 15, age < 32)
  
  return(d.data)
  }

norwegian.grammar.by.item <- grammar.by.item(d.norwegian)
english.grammar.by.item <- grammar.by.item(d.english)
danish.grammar.by.item <- grammar.by.item(d.danish)
spanish.grammar.by.item <- grammar.by.item(d.spanish)
```

Fit models for each wordform and complexity item and get their age coefficients.
```{r item_models}
lang.item.models <- function(grammar.by.item) {
  
  item.models <- grammar.by.item %>%
    group_by(item) %>%
    do(definition = .$definition[[1]],
       coded.type = .$coded.type[[1]],
       model = glm(value ~ vocab.mean + age, data = ., family = "binomial")) %>%
    mutate(definition = definition[[1]],
           coded.type = coded.type[[1]],
           coef = coef(model)["age"],
           se = se.coef(model)["age"]) %>%
    arrange(coef) %>%
    mutate(item = factor(item, levels=item))
  
  item.models$coded.type = factor(item.models$coded.type,
                                  levels = c("word_form",
                                             "morphology",
                                             "syntax"),
                                  labels = c("Word Form",
                                             "Complexity (Morphological)",
                                             "Complexity (Syntactic)"))
  
  return(item.models)
  }

norwegian.item.models <- lang.item.models(norwegian.grammar.by.item)
english.item.models <- lang.item.models(english.grammar.by.item)
danish.item.models <-  lang.item.models(danish.grammar.by.item)
spanish.item.models <- lang.item.models(spanish.grammar.by.item)
```

Function for plotting age effect coefficients by item for a language.
```{r fun_item_coef_plot}
plot.item.coefs <- function(lang.items, language) {
  item.plot <- ggplot(lang.items,
                      aes(x=item, y=coef, fill=coded.type, label=item)) +
    geom_bar(stat="identity", position="identity", alpha=.5, width=0.9) +
    #    geom_text(y=0.15, angle=90, hjust=0, size=3.3, parse=F) +
    geom_linerange(aes(ymin=coef-1.96*se, ymax=coef+1.96*se),
                   position = position_dodge(width=.9)) +
    theme_bw(base_size = 12) +
    scale_y_continuous(name="Age Effect Coefficient") +
    scale_x_discrete(name="",breaks=NULL) +
    annotate("text", x = length(lang.items$item)/2,
             y = min(lang.items$coef-1.96*lang.items$se), vjust=0,
             label = language, size = 9, family=font) +
    scale_fill_brewer(palette="Set2", name="Item Type", drop=FALSE) +
    theme(legend.position = c(0.2,0.82),
          legend.text = element_text(size=14),
          legend.title = element_text(size=13),
          legend.key = element_blank(),
          legend.key.height = unit(1.5, "char"),
          text = element_text(family=font),
          axis.title.y = element_text(size=16),
          axis.text.y = element_text(size=13))
  return(item.plot)
  }
```

Plot item interactions for Norwegian.
```{r item_coef_plot_norwegian, fig.width=8, fig.height=4}
plot.item.coefs(norwegian.item.models, "Norwegian")
```
```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/norwegian_interactions.png"), width=8, height=4)
```

Plot item interactions for English.
```{r item_coef_plot_english, fig.width=8, fig.height=4}
plot.item.coefs(english.item.models, "English")
```
```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/english_interactions.png"), width=8, height=4)
```

Plot item interactions for Danish.
```{r item_coef_plot_danish, fig.width=8, fig.height=4}
plot.item.coefs(danish.item.models, "Danish")
```
```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/danish_interactions.png"), width=8, height=4)
```

Plot item interactions for Spanish.
```{r item_coef_plot_spanish, fig.width=8, fig.height=4}
plot.item.coefs(spanish.item.models, "Spanish")
```
```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/spanish_interactions.png"), width=8, height=4)
```


***

## Analysis 2: Vocabulary Composition

Function for computing vocabulary composition for each speaker of a language.
```{r fun_comp}
vocab.composition <- function(lang.data, lang) {  
  
  d.vocab <- language.vocab.sizes(lang.data)
  
  d.cat <- lang.data %>%
    filter(type == "word") %>%
    group_by(id,lexical_category) %>%
    summarise(cat = sum(value == "produces", na.rm=TRUE))
  
  d.vocab.comp <- left_join(d.vocab, d.cat) %>%
    mutate(prop = cat / vocab.sum)
  d.vocab.comp$language = lang
  
  return(d.vocab.comp)
  }
```

Function for computing CDI form composition for all languages.
```{r fun_form_comp}
lang.vocab.composition <- function(lang.items) {  
  
  lang.words <- lang.items %>%
    filter(form == "WS",type=="word")
  
  lang.num.total <- lang.words %>%
    group_by(language) %>%
    summarise(n = n())
  
  lang.vocab.comp <-  lang.words %>%
    group_by(language,lexical_category) %>%
    summarise(num.per.cat = n())
  
  lang.vocab.comp <- left_join(lang.vocab.comp, lang.num.total) %>%
    mutate(prop.per.cat = num.per.cat/n)
  
  return(lang.vocab.comp)
  
  }
```

Get vocabulary composition data for all languages.
```{r comp}
# get form compositions
lang.vocab.comp <- lang.vocab.composition(items) %>%
  ungroup() %>%
  mutate(language = factor(language,
                           levels = c("Norwegian", "English", 
                                      "Danish", "Spanish")),
         lexical_category = factor(lexical_category, 
                                   levels=c("nouns","predicates",
                                            "function_words","other"),
                                   labels=c("Nouns", "Predicates",
                                            "Function Words","Other"))) %>%
  filter(lexical_category != "Other")

# get data for kids in each language
vocab.comp.norwegian <- vocab.composition(d.norwegian, "Norwegian")
vocab.comp.english <- vocab.composition(d.english, "English")
vocab.comp.danish <- vocab.composition(d.danish, "Danish")
vocab.comp.spanish <- vocab.composition(d.spanish, "Spanish")

# aggregate data for all languages together
summary.vocab.comp <- rbind_list(vocab.comp.norwegian, vocab.comp.english,
                                 vocab.comp.danish, vocab.comp.spanish) %>%
  mutate(language = factor(language,
                           levels = c("Norwegian", "English", 
                                      "Danish", "Spanish")),
         lexical_category = factor(lexical_category, 
                                   levels = c("nouns", "predicates", 
                                              "function_words", "other"),
                                   labels = c("Nouns", "Predicates", 
                                              "Function Words", "Other")))
summary.vocab.comp <- left_join(ms, summary.vocab.comp)
```

Compute vocabulary composition data as a proportion of items on the CDI.
```{r prop_comp}
prop.comp <- left_join(filter(summary.vocab.comp, lexical_category != "Other"),
                       lang.vocab.comp) %>%
  mutate(cdi.prop = cat / num.per.cat,
         cat.diff = num.per.cat - cat) %>%
  select(-prop, -prop.per.cat, -n)
```

Fit vocabulary composition models and use them to predict data.
```{r comp_predict}
comp.predicted.data <- prop.comp %>%
  filter(!is.na(cdi.prop)) %>%
  select(id, age, vocab.mean, age.group, language, lexical_category,
         cat, num.per.cat, cdi.prop, cat.diff)
comp.predicted.data$predicted <- NA

for (lang in c("Norwegian", "English", "Danish", "Spanish")) {
  for (lexcat in c("Nouns", "Predicates", "Function Words")) {
    model <- glm(cbind(cat,cat.diff) ~ vocab.mean,
                 data = filter(comp.predicted.data,
                               language==lang, lexical_category==lexcat),
                 family="binomial")
    predict <- invlogit(predict.lm(model,
                                   comp.predicted.data[comp.predicted.data$language==lang & comp.predicted.data$lexical_category==lexcat,]))
    comp.predicted.data[comp.predicted.data$language==lang & comp.predicted.data$lexical_category==lexcat,]$predicted <- predict
    }
  }
```

Plot vocabulary composition as a function of vocabulary size for each language with model prediction curves.
```{r comp_data_plot, fig.width=10, fig.height=2.9}
ggplot(filter(comp.predicted.data, lexical_category != "Other"),
       aes(x=vocab.mean, y=cdi.prop, colour=lexical_category,
           label=lexical_category)) +
  geom_jitter(alpha=0.15, size=.75) +
  geom_line(aes(y=predicted),size=0.65) + 
  facet_wrap(~ language, nrow = 1, ncol = 4,) +
  scale_y_continuous(limits = c(0, 1.05), breaks = seq(0,1,.2),
                     name = "Proportion of CDI Category") +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,.2),
                     name = "Vocabulary Size") +
  theme_bw(base_size=12) + 
  theme(legend.position = c(0.06,0.83),
        legend.text = element_text(size=9),
        legend.title = element_text(size=9, lineheight=unit(0.8, "char")),
        legend.key.height = unit(0.8, "char"),
        legend.key.width = unit(0.3, "cm"),
        legend.key = element_blank(),
        legend.background = element_rect(fill="transparent"),
        text = element_text(family=font)) +
  scale_color_brewer(palette = "Set2", name = "Lexical Category")
```

```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/composition_fit.png"), width=10, height=2.9, dpi=300)
```

Fit vocabulary composition models and get their AICs and age coefficients.
```{r comp_models}
comp.models <- prop.comp %>%
  filter(!is.na(sum)) %>%
  group_by(language, lexical_category) %>%
  do(model.vocab = glm(cbind(cat,cat.diff) ~ vocab.mean, data = .,
                       family="binomial"),
     model.vocab.age = glm(cbind(cat,cat.diff) ~ vocab.mean + age, data = .,
                           family="binomial")) %>%
  mutate(AIC.vocab = AIC(model.vocab),
         AIC.vocab.age = AIC(model.vocab.age),
         deltaAIC = AIC.vocab - AIC.vocab.age,
         age.coef = coef(model.vocab.age)["age"],
         age.se = se.coef(model.vocab.age)["age"])
```

Show AICs of vocabulary composition models.
```{r comp_aic}
display.comp.models <- comp.models %>%
  select(language, lexical_category, AIC.vocab, AIC.vocab.age, deltaAIC)
kable(display.comp.models)
```

Plot age effect coefficients for each language and lexical category.
```{r comp_coef_plot, fig.width=6, fig.height=4}
ggplot(comp.models, 
       aes(x=language, y=age.coef, fill=lexical_category)) + 
  geom_bar(position="dodge", stat="identity") + 
  geom_linerange(aes(ymin=age.coef-1.96*age.se, ymax=age.coef+1.96*age.se), 
                 position = position_dodge(width=.9)) +
  ylab("Age effect coefficient") + 
  xlab("Language") +
  theme_bw(base_size = 14) +
  scale_fill_brewer(palette = "Set2",
                    name = "Lexical Category") +
  theme(legend.position = c(0.17,0.83),
        legend.text = element_text(size=13),
        legend.title = element_text(size=13),
        legend.key.height = unit(1.5, "char"),
        legend.key = element_blank(),
        legend.background = element_rect(fill="transparent"),
        text = element_text(family=font))
```

```{r, include=FALSE}
#ggsave(file=("~/Documents/projects/cdi-grammar/cogsci_paper/plots/coefs_vocab_comp.png"), width=6, height=4)
```